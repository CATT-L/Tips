<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.51">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="http://tva1.sinaimg.cn/large/8697b072gy1h6njz4podsj2046046glf.jpg"><title>Command 命令 | Hyperf 框架规范</title><meta name="description" content=" ">
    <link rel="modulepreload" href="/hyperf-reference/assets/app.297635da.js"><link rel="modulepreload" href="/hyperf-reference/assets/command.html.74d14b1d.js"><link rel="modulepreload" href="/hyperf-reference/assets/command.html.e7f84f14.js"><link rel="prefetch" href="/hyperf-reference/assets/index.html.ba687ed3.js"><link rel="prefetch" href="/hyperf-reference/assets/controller.html.f9f0c3f5.js"><link rel="prefetch" href="/hyperf-reference/assets/crontab.html.ba1b69cc.js"><link rel="prefetch" href="/hyperf-reference/assets/service.html.ecb83344.js"><link rel="prefetch" href="/hyperf-reference/assets/dao.html.12b845ce.js"><link rel="prefetch" href="/hyperf-reference/assets/entity.html.80029b1f.js"><link rel="prefetch" href="/hyperf-reference/assets/index.html.fe27fa4a.js"><link rel="prefetch" href="/hyperf-reference/assets/404.html.c3e557d0.js"><link rel="prefetch" href="/hyperf-reference/assets/index.html.b40ea19d.js"><link rel="prefetch" href="/hyperf-reference/assets/controller.html.ac1d9d1e.js"><link rel="prefetch" href="/hyperf-reference/assets/crontab.html.7a23e124.js"><link rel="prefetch" href="/hyperf-reference/assets/service.html.b6de496c.js"><link rel="prefetch" href="/hyperf-reference/assets/dao.html.f0b1d16b.js"><link rel="prefetch" href="/hyperf-reference/assets/entity.html.59b4d572.js"><link rel="prefetch" href="/hyperf-reference/assets/index.html.bbfaa4d7.js"><link rel="prefetch" href="/hyperf-reference/assets/404.html.d543e0e7.js">
    <link rel="stylesheet" href="/hyperf-reference/assets/style.d9f5775d.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/hyperf-reference/" class=""><img class="logo" src="http://tva1.sinaimg.cn/large/8697b072gy1h6njz4podsj2046046glf.jpg" alt="Hyperf 框架规范"><span class="site-name can-hide">Hyperf 框架规范</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a class="external-link" href="http://myappgo.com:1180/xiaoetech/wiki-hyperf-reference" rel="noopener noreferrer" target="_blank" aria-label="Source"><!--[--><!--]--> Source <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a class="external-link" href="http://myappgo.com:1180/xiaoetech/wiki-hyperf-reference" rel="noopener noreferrer" target="_blank" aria-label="Source"><!--[--><!--]--> Source <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">概述 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/hyperf-reference/" class="sidebar-item" aria-label="大纲"><!--[--><!--]--> 大纲 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading active">入口 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/hyperf-reference/reference/enter-point/controller.html" class="sidebar-item" aria-label="Controller 控制器"><!--[--><!--]--> Controller 控制器 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/hyperf-reference/reference/enter-point/command.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="Command 命令"><!--[--><!--]--> Command 命令 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/hyperf-reference/reference/enter-point/command.html#基本概念" class="router-link-active router-link-exact-active sidebar-item" aria-label="基本概念"><!--[--><!--]--> 基本概念 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/hyperf-reference/reference/enter-point/command.html#目录规范" class="router-link-active router-link-exact-active sidebar-item" aria-label="目录规范"><!--[--><!--]--> 目录规范 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/hyperf-reference/reference/enter-point/command.html#代码规范" class="router-link-active router-link-exact-active sidebar-item" aria-label="代码规范"><!--[--><!--]--> 代码规范 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/hyperf-reference/reference/enter-point/command.html#基本框架" class="router-link-active router-link-exact-active sidebar-item" aria-label="基本框架"><!--[--><!--]--> 基本框架 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/hyperf-reference/reference/enter-point/command.html#执行名称" class="router-link-active router-link-exact-active sidebar-item" aria-label="执行名称"><!--[--><!--]--> 执行名称 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/hyperf-reference/reference/enter-point/command.html#业务代码" class="router-link-active router-link-exact-active sidebar-item" aria-label="业务代码"><!--[--><!--]--> 业务代码 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/hyperf-reference/reference/enter-point/command.html#摒弃的方案" class="router-link-active router-link-exact-active sidebar-item" aria-label="摒弃的方案"><!--[--><!--]--> 摒弃的方案 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/hyperf-reference/reference/enter-point/command.html#在-command-中运行其他命令" class="router-link-active router-link-exact-active sidebar-item" aria-label="❌ 在 Command 中运行其他命令"><!--[--><!--]--> ❌ 在 Command 中运行其他命令 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/hyperf-reference/reference/enter-point/command.html#在非-command-中运行命令" class="router-link-active router-link-exact-active sidebar-item" aria-label="❌ 在非 Command 中运行命令"><!--[--><!--]--> ❌ 在非 Command 中运行命令 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><a href="/hyperf-reference/reference/enter-point/crontab.html" class="sidebar-item" aria-label="Crontab 定时任务"><!--[--><!--]--> Crontab 定时任务 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">业务 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/hyperf-reference/reference/service/service.html" class="sidebar-item" aria-label="Service 业务层"><!--[--><!--]--> Service 业务层 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">模型 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/hyperf-reference/reference/model/" class="sidebar-item" aria-label="Model 模型"><!--[--><!--]--> Model 模型 <!--[--><!--]--></a><!----></li><li><a href="/hyperf-reference/reference/model/entity.html" class="sidebar-item" aria-label="Model-Entity 数据实体"><!--[--><!--]--> Model-Entity 数据实体 <!--[--><!--]--></a><!----></li><li><a href="/hyperf-reference/reference/model/dao.html" class="sidebar-item" aria-label="Model-Dao 数据访问对象"><!--[--><!--]--> Model-Dao 数据访问对象 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="command-命令" tabindex="-1"><a class="header-anchor" href="#command-命令" aria-hidden="true">#</a> Command 命令</h1><h2 id="基本概念" tabindex="-1"><a class="header-anchor" href="#基本概念" aria-hidden="true">#</a> 基本概念</h2><p>命令是在服务端执行 PHP 脚本的入口，通过下方语句可以查看命令列表：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>php bin/hyperf.php
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>通过下方语句执行对应的命令，例如 <code>demo:echo</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>php bin/hyperf.php demo:echo
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>若有需要，也可以携带参数, 例如 <code>demo:params</code> 需要携带一些参数</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>php bin/hyperf.php demo:params <span class="token parameter variable">--class</span><span class="token operator">=</span><span class="token string">&quot;G305&quot;</span> <span class="token parameter variable">--name</span><span class="token operator">=</span><span class="token string">&quot;张三&quot;</span> <span class="token parameter variable">--number</span><span class="token operator">=</span><span class="token string">&quot;1503050025&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>上述语句因为在命令行里执行，为便于观看，当然可以用命令行的换行写法, 即末尾加 <code>[空格]\</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>php bin/hyperf.php demo:params <span class="token punctuation">\</span>
<span class="token parameter variable">--class</span><span class="token operator">=</span><span class="token string">&quot;G305&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--name</span><span class="token operator">=</span><span class="token string">&quot;张三&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--number</span><span class="token operator">=</span><span class="token string">&quot;150300025&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>更多细节内容请查看 <a href="https://hyperf.wiki/2.2/#/zh-cn/command" target="_blank" rel="noopener noreferrer">官方文档<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="目录规范" tabindex="-1"><a class="header-anchor" href="#目录规范" aria-hidden="true">#</a> 目录规范</h2><p>参考 Controller 控制器。</p><p>类名以 Command 为后缀。</p><h2 id="代码规范" tabindex="-1"><a class="header-anchor" href="#代码规范" aria-hidden="true">#</a> 代码规范</h2><h3 id="基本框架" tabindex="-1"><a class="header-anchor" href="#基本框架" aria-hidden="true">#</a> 基本框架</h3><p>下方是一个最小化的 Command 代码片段</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Command<span class="token punctuation">\</span>Demo</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Hyperf<span class="token punctuation">\</span>Command<span class="token punctuation">\</span>Annotation<span class="token punctuation">\</span>Command</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * @Command()
 */</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">DemoEchoCommand</span> <span class="token keyword">extends</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>Hyperf<span class="token punctuation">\</span>Command<span class="token punctuation">\</span>Command</span> <span class="token punctuation">{</span>

    <span class="token keyword">protected</span> <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;demo:echo&#39;</span><span class="token punctuation">;</span>

    <span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token variable">$defaultDescription</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;示例/回显&#39;</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">handle</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>需要注意的地方：</p><ul><li>通过注解 <code>@Command</code> 来标识它是一份命令行代码</li><li>继承 <code>\Hyperf\Command\Command</code> 类 <blockquote><p>可以注意到它与注解重名，但请不要重命名它<br> 因为写起来很麻烦，且没有必要</p></blockquote></li><li><code>$name</code> 是命令行的执行名称，也就是上面 <code>php bin/hyperf.php &lt;执行名称&gt;</code> 后面的东西</li><li><code>static $defaultDescription</code> 是给人看的介绍，在执行 <code>php bin/hyperf.php</code> 的时候，会展示</li><li><code>function handle ()</code> 是执行的代码入口</li></ul><h3 id="执行名称" tabindex="-1"><a class="header-anchor" href="#执行名称" aria-hidden="true">#</a> 执行名称</h3><p>在列表中，执行名称会以第一个冒号 <code>:</code> 进行分组，因此我们命名的时候，也要根据不同的功能点，来确定第一个冒号的位置。<br> 后面也可以出现多个冒号，没啥影响。</p><p>在命名的时候，以短横线 <code>-</code> 来替换空格（短横线命名法）, 这是为了方便阅读和输入。</p><blockquote><p>驼峰命名不方便阅读，但方便输入；<br> 下划线命名方便阅读，但不方便输入；<br> 而短横线命名，就既方便阅读，也方便输入啦！</p></blockquote><hr><p>例子：</p><ul><li>抽奖功能-扫描符合开奖条件的记录触发开奖 <blockquote><p>执行名称：lottery:scan-trigger-run<br> 命令介绍：抽奖-扫描符合开奖条件的记录触发开奖</p></blockquote></li></ul><h3 id="业务代码" tabindex="-1"><a class="header-anchor" href="#业务代码" aria-hidden="true">#</a> 业务代码</h3><h4 id="类名" tabindex="-1"><a class="header-anchor" href="#类名" aria-hidden="true">#</a> 类名</h4><p>业务代码放在业务层相应功能的目录下，以 Command 开头、Service 结尾，其类名尽量与对应 Command 一致。</p><p>一份命令行业务类，专注一个操作，不要把不同的操作混在一起。</p><p>例如：</p><ul><li>Command 类名： <code>DemoEchoCommand</code></li><li>Service 类名: <code>CommandDemoEchoService</code></li></ul><h4 id="入口函数" tabindex="-1"><a class="header-anchor" href="#入口函数" aria-hidden="true">#</a> 入口函数</h4><p>若无特殊情况，入口函数统一为 <code>public function handle ($params)</code>。</p><h4 id="调用方式" tabindex="-1"><a class="header-anchor" href="#调用方式" aria-hidden="true">#</a> 调用方式</h4><p>Command 代码里不需要搞对象注入，一般就一个调用点而已，直接用 <code>di</code> 函数注入调用更方便。</p><p>例如：</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Command<span class="token punctuation">\</span>Demo</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Hyperf<span class="token punctuation">\</span>Command<span class="token punctuation">\</span>Annotation<span class="token punctuation">\</span>Command</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Service<span class="token punctuation">\</span>Demo<span class="token punctuation">\</span>CommandDemoEchoService<span class="token punctuation">\</span>CommandDemoEchoService</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * @Command()
 */</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">DemoEchoCommand</span> <span class="token keyword">extends</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>Hyperf<span class="token punctuation">\</span>Command<span class="token punctuation">\</span>Command</span> <span class="token punctuation">{</span>

    <span class="token keyword">protected</span> <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;demo:echo&#39;</span><span class="token punctuation">;</span>

    <span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token variable">$defaultDescription</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;示例/回显&#39;</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">handle</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

      <span class="token function">di</span><span class="token punctuation">(</span><span class="token class-name static-context">CommandDemoEchoService</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
          <span class="token string single-quoted-string">&#39;from&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;命令:示例/回显&#39;</span><span class="token punctuation">,</span>
          <span class="token string single-quoted-string">&#39;time&#39;</span> <span class="token operator">=&gt;</span> <span class="token function">date</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Y-m-d H:i:s&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</span></code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="传入参数" tabindex="-1"><a class="header-anchor" href="#传入参数" aria-hidden="true">#</a> 传入参数</h4><p>通过重写 configure() 函数，在里面调用 addOption() 的方式配置传入参数，随后可在代码入口，通过 $input 对象读取。</p><p>详情见下方代码示例。</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>


<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Command<span class="token punctuation">\</span>Demo</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Service<span class="token punctuation">\</span>Demo<span class="token punctuation">\</span>CommandDemoParamsService</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Utils<span class="token punctuation">\</span>ValidateUtils</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Hyperf<span class="token punctuation">\</span>Command<span class="token punctuation">\</span>Annotation<span class="token punctuation">\</span>Command</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Symfony<span class="token punctuation">\</span>Component<span class="token punctuation">\</span>Console<span class="token punctuation">\</span>Input<span class="token punctuation">\</span>InputOption</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * @Command()
 */</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">DemoParamsCommand</span> <span class="token keyword">extends</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>Hyperf<span class="token punctuation">\</span>Command<span class="token punctuation">\</span>Command</span> <span class="token punctuation">{</span>

    <span class="token keyword">protected</span> <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;demo:params&#39;</span><span class="token punctuation">;</span>

    <span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token variable">$defaultDescription</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;示例/带参数&#39;</span><span class="token punctuation">;</span>

    <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function-definition function">configure</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword static-context">parent</span><span class="token operator">::</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">addOption</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;class&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token class-name static-context">InputOption</span><span class="token operator">::</span><span class="token constant">VALUE_REQUIRED</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;班级&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">addOption</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;name&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token class-name static-context">InputOption</span><span class="token operator">::</span><span class="token constant">VALUE_REQUIRED</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;姓名&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">addOption</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;number&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token class-name static-context">InputOption</span><span class="token operator">::</span><span class="token constant">VALUE_REQUIRED</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;学号&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">handle</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token variable">$params</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">&#39;class&#39;</span>  <span class="token operator">=&gt;</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">input</span><span class="token operator">-&gt;</span><span class="token function">getOption</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;class&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&#39;name&#39;</span>   <span class="token operator">=&gt;</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">input</span><span class="token operator">-&gt;</span><span class="token function">getOption</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&#39;number&#39;</span> <span class="token operator">=&gt;</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">input</span><span class="token operator">-&gt;</span><span class="token function">getOption</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;number&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token class-name static-context">ValidateUtils</span><span class="token operator">::</span><span class="token function">mustValidate</span><span class="token punctuation">(</span><span class="token variable">$params</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">&#39;class&#39;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&#39;name&#39;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&#39;number&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">di</span><span class="token punctuation">(</span><span class="token class-name static-context">CommandDemoParamsService</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">handle</span><span class="token punctuation">(</span><span class="token variable">$params</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</span></code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><br><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="摒弃的方案" tabindex="-1"><a class="header-anchor" href="#摒弃的方案" aria-hidden="true">#</a> 摒弃的方案</h2><h3 id="在-command-中运行其他命令" tabindex="-1"><a class="header-anchor" href="#在-command-中运行其他命令" aria-hidden="true">#</a> ❌ 在 Command 中运行其他命令</h3><p>因为命令行代码是执行入口，如果我们在这里调用其他的命令行代码，会变得混乱，因此我们避免这种操作。</p><p>并且我们的逻辑下放到了 Service 业务层，若有必要，在业务层同层级调用即可。</p><h3 id="在非-command-中运行命令" tabindex="-1"><a class="header-anchor" href="#在非-command-中运行命令" aria-hidden="true">#</a> ❌ 在非 Command 中运行命令</h3><p>首先列举一下可以执行的位置：</p><ul><li>同层级，即其他的入口 （例如控制器、定时任务之类的）</li><li>下层级，即业务层或者模型层，倒回来调用命令</li></ul><p>下面逐一解释</p><h4 id="上层级" tabindex="-1"><a class="header-anchor" href="#上层级" aria-hidden="true">#</a> 上层级</h4><p>代码入口会有上层级吗？它自身就是最顶层了，所以上面也就没列举。不需要考虑这种情况。</p><h4 id="同层级" tabindex="-1"><a class="header-anchor" href="#同层级" aria-hidden="true">#</a> 同层级</h4><p>大家都是代码入口，请不要这样调用其他的入口，不然会造成混乱。</p><h4 id="下层级" tabindex="-1"><a class="header-anchor" href="#下层级" aria-hidden="true">#</a> 下层级</h4><p>代码应当自上而下调用，最多做到同层级调用（例如业务层）。<br> 如果从下往上调用，那可真是乱成一锅粥了！</p><p>例如：</p><ul><li>❌ 模型层调用业务层</li><li>❌ 业务层调用入口层</li></ul></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="http://myappgo.com:1180/xiaoetech/wiki-hyperf-reference/-/edit/develop/docs/reference/enter-point/command.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!----><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/hyperf-reference/reference/enter-point/controller.html" class="" aria-label="Controller 控制器"><!--[--><!--]--> Controller 控制器 <!--[--><!--]--></a></span><span class="next"><a href="/hyperf-reference/reference/enter-point/crontab.html" class="" aria-label="Crontab 定时任务"><!--[--><!--]--> Crontab 定时任务 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/hyperf-reference/assets/app.297635da.js" defer></script>
  </body>
</html>
